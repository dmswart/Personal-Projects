<html>
<head>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="./skeleton.js"></script>
<script src="./parse_globemaker.js"></script>
</head>

<body>
<div style="width: 100%; overflow: hidden;">
    <div id="output" style="width: 500px; float: left;"></div>
    <div style="margin-left: 520px;"> 
        <textarea id="input" type="text" cols=40 rows=32 style="overflow:scroll" onchange="newSkeleton(this.value);">l 0</textarea>
    </div>
</div>
</body>

</html>

<script>
    var svg = d3.select("#output").append("svg")
            .attr("width", 500)
            .attr("height",500)
    svg.append("rect")
        .attr("width", "100%")
        .attr("height", "100%")
        .attr("stroke", "gray")
        .attr("stroke-width", 1)
        .attr("fill", "silver");
    svg.append("path")
        .attr("id", "moves")
        .attr("stroke", "blue")
        .attr("stroke-dasharray", "5,5")
        .attr("stroke-width", 2)
        .attr("fill", "none");
    svg.append("path")
        .attr("id", "lines")
        .attr("stroke", "blue")
        .attr("stroke-width", 2)
        .attr("fill", "none");

    var newSkeleton = function(skeleton_def) {
        var skel = new skeleton(100);
        if(parse_globemaker(skeleton_def, skel)) {
            svg.select("#moves")
                .attr("d", skel.toString('move'));
            svg.select("#lines")
                .attr("d", skel.toString('line'));
            d3.select("#input")
                .attr("style", "background-color:white");
        } else {
            d3.select("#input")
                .attr("style", "background-color:pink");
        }
    }
</script>
